name: Build test and quality checks
on: push
jobs:
  Actions:
    runs-on: ubuntu-20.04
    steps:
      - name: Clone DietPi-Website repository
        id: clone
        uses: actions/checkout@v2
      - name: Check HTML5 syntax
        uses: Cyb3r-Jak3/html5validator-action@v0.4.2
        with:
          root: .
          css: true
      - name: Deploy DietPi-Website locally
        if: always() && steps.clone.outcome == 'success'
        id: deploy
        run: bash deplay.bash site
      - name: Check links in HTML files
        id: check_links
        if: always() && steps.deploy.outcome == 'success'
        uses: peter-evans/link-checker@v1
        with:
          args: -x '^/?(docs|downloads|phpbb|survey)/' -d site -r README.md site
      - name: Check link check result
        if: always() && steps.deploy.outcome == 'success'
        run: exit ${{ steps.check_links.outputs.exit_code }}
      - name: Check spelling in HTML files
        if: always() && steps.deploy.outcome == 'success'
        # .spellcheck.yml: https://github.com/marketplace/actions/github-spellcheck-action#spellcheck-configuration-file
        # .wordlist.txt
        uses: rojopolis/spellcheck-github-actions@0.5.0
